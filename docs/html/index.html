
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>bptools &#8212; bptools 1.1.2 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">bptools 1.1.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="bptools">
<h1>bptools<a class="headerlink" href="#bptools" title="Permalink to this headline">¶</a></h1>
<p>EEG bipolar montage helpers.</p>
<div class="section" id="electrode-config-generation">
<h2>Electrode config generation<a class="headerlink" href="#electrode-config-generation" title="Permalink to this headline">¶</a></h2>
<p>Electrode configuration CSV files can be generated for the Medtronic Odin ENS
using the CLI tool provided in <code class="xref py py-mod docutils literal"><span class="pre">bptools.odin</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">bptools</span><span class="o">.</span><span class="n">odin</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">scheme</span> <span class="p">{</span><span class="n">bipolar</span><span class="p">,</span><span class="n">monopolar</span><span class="p">}]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">jacksheet</span> <span class="n">JACKSHEET</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">good</span><span class="o">-</span><span class="n">leads</span> <span class="n">GOOD_LEADS</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">localization</span> <span class="n">LOCALIZATION</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">montage</span> <span class="n">MONTAGE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">stim</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">surface</span><span class="o">-</span><span class="n">area</span> <span class="n">SURFACE_AREA</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="n">OUTPUT_PATH</span><span class="p">]</span>
                              <span class="p">[</span><span class="o">--</span><span class="n">rhino</span><span class="o">-</span><span class="n">root</span> <span class="n">RHINO_ROOT</span><span class="p">]</span> <span class="o">--</span><span class="n">subject</span> <span class="n">SUBJECT</span>

<span class="n">Odin</span> <span class="n">config</span> <span class="n">generator</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">scheme</span> <span class="p">{</span><span class="n">bipolar</span><span class="p">,</span><span class="n">monopolar</span><span class="p">}</span>
                        <span class="n">configuration</span> <span class="n">scheme</span> <span class="n">to</span> <span class="n">use</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">bipolar</span><span class="p">)</span>
  <span class="o">--</span><span class="n">jacksheet</span> <span class="n">JACKSHEET</span><span class="p">,</span> <span class="o">-</span><span class="n">j</span> <span class="n">JACKSHEET</span>
                        <span class="n">path</span> <span class="n">to</span> <span class="n">jacksheet</span> <span class="n">file</span>
  <span class="o">--</span><span class="n">good</span><span class="o">-</span><span class="n">leads</span> <span class="n">GOOD_LEADS</span><span class="p">,</span> <span class="o">-</span><span class="n">g</span> <span class="n">GOOD_LEADS</span>
                        <span class="n">path</span> <span class="n">to</span> <span class="n">good_leads</span><span class="o">.</span><span class="n">txt</span>
  <span class="o">--</span><span class="n">localization</span> <span class="n">LOCALIZATION</span><span class="p">,</span> <span class="o">-</span><span class="n">l</span> <span class="n">LOCALIZATION</span>
                        <span class="n">localization</span> <span class="n">number</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
  <span class="o">--</span><span class="n">montage</span> <span class="n">MONTAGE</span><span class="p">,</span> <span class="o">-</span><span class="n">m</span> <span class="n">MONTAGE</span>
                        <span class="n">montage</span> <span class="n">number</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
  <span class="o">--</span><span class="n">stim</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span>            <span class="n">flag</span> <span class="n">to</span> <span class="n">enable</span> <span class="n">stim</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
  <span class="o">--</span><span class="n">surface</span><span class="o">-</span><span class="n">area</span> <span class="n">SURFACE_AREA</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span> <span class="n">SURFACE_AREA</span>
                        <span class="n">default</span> <span class="n">surface</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">mm</span><span class="o">^</span><span class="mi">2</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">)</span>
  <span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="n">OUTPUT_PATH</span><span class="p">,</span> <span class="o">-</span><span class="n">o</span> <span class="n">OUTPUT_PATH</span>
                        <span class="n">directory</span> <span class="n">to</span> <span class="n">write</span> <span class="n">output</span> <span class="n">to</span>
  <span class="o">--</span><span class="n">rhino</span><span class="o">-</span><span class="n">root</span> <span class="n">RHINO_ROOT</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span> <span class="n">RHINO_ROOT</span>
                        <span class="n">rhino</span> <span class="n">root</span> <span class="n">path</span> <span class="k">for</span> <span class="n">jacksheet</span> <span class="n">discovery</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
  <span class="o">--</span><span class="n">subject</span> <span class="n">SUBJECT</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span> <span class="n">SUBJECT</span>
                        <span class="n">subject</span> <span class="n">ID</span>
</pre></div>
</div>
<p>If no jacksheet is specified, the script will try to automatically find it based
on the subject ID.</p>
<p>The general workflow is as follows:</p>
<ol class="arabic simple">
<li>Generate CSV config file with the script provided here.</li>
<li>Edit the CSV config file to include the proper surface areas for each contact.</li>
<li>Load the CSV config in the Odin configuration tool.</li>
<li>Define stim channels if applicable.</li>
<li>Save the CSV config file.</li>
<li>Save the binary config file.</li>
</ol>
<p>To run the script, either run from the root directory of <code class="docutils literal"><span class="pre">bptools</span></code>, add said
directory to your <code class="docutils literal"><span class="pre">PYTHONPATH</span></code>, or run <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code> so that it
is always reachable from your environment.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Stimulation channels must be defined manually via the Odin configuration
tool GUI.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In order to properly handle micro contacts on combined macro/micro
electrodes, labels in the jacksheet <strong>must</strong> be different for the macro and
micro contacts when using bipolar referencing.</p>
</div>
<div class="section" id="known-issues">
<h3>Known issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h3>
<p>There is a bug in the Odin configuration tool which will silently accept the
same primary contact in multiple sense channels. For example, it would indicate
passing all checks if there were pairs defined as <code class="docutils literal"><span class="pre">LA1-LA2</span></code> and <code class="docutils literal"><span class="pre">LA1-LA9</span></code>.
This is handled automatically in the CSV generation script by flipping the order
of contacts in the case of distal pairings. In other words, the pairs above will
instead be defined as <code class="docutils literal"><span class="pre">LA1-LA2</span></code> and <code class="docutils literal"><span class="pre">LA9-LA1</span></code>.</p>
</div>
</div>
<div class="section" id="api-reference">
<h2>API reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-bptools.jacksheet">
<span id="jacksheet-utilities"></span><h3>Jacksheet utilities<a class="headerlink" href="#module-bptools.jacksheet" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="bptools.jacksheet.read_jacksheet">
<code class="descclassname">bptools.jacksheet.</code><code class="descname">read_jacksheet</code><span class="sig-paren">(</span><em>filename</em>, <em>ignore_ecg=True</em>, <em>standardize_labels=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/jacksheet.html#read_jacksheet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.jacksheet.read_jacksheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to read a jacksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) – </li>
<li><strong>ignore_ecg</strong> (<em>bool</em>) – Omit heart rate channels labeled as ECG/EKG.</li>
<li><strong>standarize_labels</strong> (<em>bool</em>) – Standarize contact labels when reading in the jacksheet</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Columns in the returned <code class="xref py py-class docutils literal"><span class="pre">pd.DataFrame</span></code>:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">label</span></code>: contact labels</li>
<li><code class="docutils literal"><span class="pre">electrode</span></code>: electrode the contact resides on (same as <code class="docutils literal"><span class="pre">label</span></code>
without the number)</li>
</ul>
<p>The index is the jackbox number.</p>
</dd></dl>

</div>
<div class="section" id="module-bptools.pairs">
<span id="pair-creation-tools"></span><h3>Pair creation tools<a class="headerlink" href="#module-bptools.pairs" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="bptools.pairs.Pair">
<em class="property">class </em><code class="descclassname">bptools.pairs.</code><code class="descname">Pair</code><span class="sig-paren">(</span><em>ch0_label</em>, <em>ch1_label</em>, <em>pair_label</em><span class="sig-paren">)</span><a class="headerlink" href="#bptools.pairs.Pair" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="bptools.pairs.Pair.ch0_label">
<code class="descname">ch0_label</code><a class="headerlink" href="#bptools.pairs.Pair.ch0_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.pairs.Pair.ch1_label">
<code class="descname">ch1_label</code><a class="headerlink" href="#bptools.pairs.Pair.ch1_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.pairs.Pair.pair_label">
<code class="descname">pair_label</code><a class="headerlink" href="#bptools.pairs.Pair.pair_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="bptools.pairs.create_monopolar_pairs">
<code class="descclassname">bptools.pairs.</code><code class="descname">create_monopolar_pairs</code><span class="sig-paren">(</span><em>jacksheet_filename</em>, <em>common_ref=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/pairs.html#create_monopolar_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.pairs.create_monopolar_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create ‘pairs’ that are referenced to a common reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>jacksheet_filename</strong> (<em>str</em>) – Path to jacksheet to read.</li>
<li><strong>common_ref</strong> (<em>int</em>) – Contact number to use as common reference.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pairs</strong> – See the documentation for <a class="reference internal" href="#bptools.pairs.create_pairs" title="bptools.pairs.create_pairs"><code class="xref py py-func docutils literal"><span class="pre">create_pairs()</span></code></a> for details.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bptools.pairs.create_pairs">
<code class="descclassname">bptools.pairs.</code><code class="descname">create_pairs</code><span class="sig-paren">(</span><em>jacksheet_filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/pairs.html#create_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.pairs.create_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines bipolar pairs for the Odin ENS given a jacksheet.</p>
<p>This uses a scheme to live within the constraints of ENS configuration,
namely that pairs cannot cross a MUX. All neighboring pairs are used, and
the first and last contacts are also paired.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jacksheet_filename</strong> (<em>str</em>) – Path to jacksheet to read.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>pairs</strong> – Columns: pair, label1, label2, contact1, contact2, mux</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pd.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bptools.pairs.pairs_to_json">
<code class="descclassname">bptools.pairs.</code><code class="descname">pairs_to_json</code><span class="sig-paren">(</span><em>pairs</em>, <em>subject</em>, <em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/pairs.html#pairs_to_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.pairs.pairs_to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a pairs <code class="xref py py-class docutils literal"><span class="pre">pd.DataFrame</span></code> to a <code class="docutils literal"><span class="pre">pairs.json</span></code> file (with
coordinates omitted).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pairs</strong> (<em>pd.DataFrame</em>) – </li>
<li><strong>subject</strong> (<em>str</em>) – Subject ID.</li>
<li><strong>path</strong> (<em>str</em>) – Path to write <code class="docutils literal"><span class="pre">pairs.json</span></code> to.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Currently, several other fields are omitted, e.g., electrode type.</p>
</dd></dl>

<dl class="function">
<dt id="bptools.pairs.read_montage_json">
<code class="descclassname">bptools.pairs.</code><code class="descname">read_montage_json</code><span class="sig-paren">(</span><em>montage_path</em>, <em>assume_monopolar=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/pairs.html#read_montage_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.pairs.read_montage_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads pairs.json.  Assumes “consecutive wiring”. i.e. when we have e.g.
130 contacts they are plugged one after another. so based on channel label
we can determine positional index of that channel For example channel
labeled 001 will have positional index 0 and channel indexed 122 will have
positional index 121</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>montage_path</strong> (<em>str</em>) – path to pairs.json</li>
<li><strong>assume_monopolar</strong> (<em>bool</em>) – specifies whether correspongind electrod</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">ndarray</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">montage recarray with the following columns:
(contact_name, ch0_label, ch1_label, ch1_idx, ch1_idx)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bptools.pairs.write_pairs">
<code class="descclassname">bptools.pairs.</code><code class="descname">write_pairs</code><span class="sig-paren">(</span><em>pairs</em>, <em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/pairs.html#write_pairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.pairs.write_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Write pairs to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pairs</strong> (<em>pd.DataFrame</em>) – </li>
<li><strong>filename</strong> (<em>str</em>) – File to write. File type is determined by the extension. Accepted file
extensions are: <code class="docutils literal"><span class="pre">.csv</span></code>, <code class="docutils literal"><span class="pre">.json</span></code>. If saving as JSON, pairs will be
saved in a minimal <code class="docutils literal"><span class="pre">pairs.json</span></code> format which excludes coordinates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>kwargs</strong> (<em>dict</em>) – Keyword arguments to pass to pandas <code class="docutils literal"><span class="pre">to_xyz</span></code> functions when writing
formats other than JSON. If writing <code class="docutils literal"><span class="pre">pairs.json</span></code>, a <code class="docutils literal"><span class="pre">subject</span></code>
keyword argument is also required.</li>
<li><strong>subject</strong> (<em>str</em>) – Subject ID.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li>ValueError when subject kwarg is missing (for writing <code class="docutils literal"><span class="pre">pairs.json</span></code>) or an</li>
<li>unsupported extension is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-bptools.odin.config">
<span id="odin-ens-configuration"></span><h3>Odin ENS configuration<a class="headerlink" href="#module-bptools.odin.config" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="bptools.odin.config.Contact">
<em class="property">class </em><code class="descclassname">bptools.odin.config.</code><code class="descname">Contact</code><span class="sig-paren">(</span><em>label</em>, <em>port</em>, <em>area</em>, <em>description</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#Contact"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.Contact" title="Permalink to this definition">¶</a></dt>
<dd><p>Data about a configured contact.</p>
</dd></dl>

<dl class="class">
<dt id="bptools.odin.config.ElectrodeConfig">
<em class="property">class </em><code class="descclassname">bptools.odin.config.</code><code class="descname">ElectrodeConfig</code><span class="sig-paren">(</span><em>filename=None</em>, <em>version=‘1.2’</em>, <em>name=”</em>, <em>subject=”</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#ElectrodeConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Representation of OdinLib electrode configuration files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – Path to Odin binary or CSV configuration file. Both must be present in
the same directory.</li>
<li><strong>version</strong> (<em>str</em>) – Odin config version number</li>
<li><strong>name</strong> (<em>str</em>) – Name given to config file (alphanumeric only)</li>
<li><strong>subject</strong> (<em>str</em>) – Subject ID</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="bptools.odin.config.ElectrodeConfig.contacts">
<code class="descname">contacts</code><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.contacts" title="Permalink to this definition">¶</a></dt>
<dd><p>list of <a class="reference internal" href="#bptools.odin.config.Contact" title="bptools.odin.config.Contact"><code class="xref py py-class docutils literal"><span class="pre">Contact</span></code></a> – Contact labels and numbers.</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.odin.config.ElectrodeConfig.sense_channels">
<code class="descname">sense_channels</code><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.sense_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>list of <a class="reference internal" href="#bptools.odin.config.SenseChannel" title="bptools.odin.config.SenseChannel"><code class="xref py py-class docutils literal"><span class="pre">SenseChannel</span></code></a> – Configured sense channels.</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.odin.config.ElectrodeConfig.stim_channels">
<code class="descname">stim_channels</code><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.stim_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>list of <a class="reference internal" href="#bptools.odin.config.StimChannel" title="bptools.odin.config.StimChannel"><code class="xref py py-class docutils literal"><span class="pre">StimChannel</span></code></a> – Configured stimulation channels.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>All <code class="docutils literal"><span class="pre">x_as_recarray</span></code> methods return a recarray with the following columns:</p>
<ul class="simple">
<li>jack_box_num - int</li>
<li>contact_name - str</li>
<li>description - str</li>
</ul>
<dl class="method">
<dt id="bptools.odin.config.ElectrodeConfig.contacts_as_recarray">
<code class="descname">contacts_as_recarray</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#ElectrodeConfig.contacts_as_recarray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.contacts_as_recarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the monopolar contacts as a recarry.</p>
<p>This method exists for Ramulator compatibility.</p>
</dd></dl>

<dl class="classmethod">
<dt id="bptools.odin.config.ElectrodeConfig.from_jacksheet">
<em class="property">classmethod </em><code class="descname">from_jacksheet</code><span class="sig-paren">(</span><em>filename</em>, <em>subject=”</em>, <em>scheme=’bipolar’</em>, <em>area=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#ElectrodeConfig.from_jacksheet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.from_jacksheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new <a class="reference internal" href="#bptools.odin.config.ElectrodeConfig" title="bptools.odin.config.ElectrodeConfig"><code class="xref py py-class docutils literal"><span class="pre">ElectrodeConfig</span></code></a> instance from a jacksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) – Path to jacksheet file.</li>
<li><strong>subject</strong> (<em>str</em>) – Subject ID</li>
<li><strong>scheme</strong> (<em>str</em>) – Referencing scheme to use (<code class="docutils literal"><span class="pre">bipolar</span></code> or <code class="docutils literal"><span class="pre">monopolar</span></code>).</li>
<li><strong>area</strong> (<em>float</em>) – Default surface area to use in mm^2.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>config</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#bptools.odin.config.ElectrodeConfig" title="bptools.odin.config.ElectrodeConfig">ElectrodeConfig</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="bptools.odin.config.ElectrodeConfig.num_contacts">
<code class="descname">num_contacts</code><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.num_contacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of configured contacts.</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.odin.config.ElectrodeConfig.num_sense_channels">
<code class="descname">num_sense_channels</code><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.num_sense_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of configured sense channels.</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.odin.config.ElectrodeConfig.num_stim_channels">
<code class="descname">num_stim_channels</code><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.num_stim_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of configured stim channels.</p>
</dd></dl>

<dl class="method">
<dt id="bptools.odin.config.ElectrodeConfig.read_config_file">
<code class="descname">read_config_file</code><span class="sig-paren">(</span><em>filename</em>, <em>standardize_labels=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#ElectrodeConfig.read_config_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.read_config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Populate the instance from an Odin electrode configuration file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – Path to Odin binary or CSV config file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bptools.odin.config.ElectrodeConfig.sense_channels_as_recarray">
<code class="descname">sense_channels_as_recarray</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#ElectrodeConfig.sense_channels_as_recarray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.sense_channels_as_recarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sense channels as a recarray.</p>
<p>This method exists for Ramulator compatibility.</p>
</dd></dl>

<dl class="method">
<dt id="bptools.odin.config.ElectrodeConfig.to_csv">
<code class="descname">to_csv</code><span class="sig-paren">(</span><em>outfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#ElectrodeConfig.to_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.ElectrodeConfig.to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Export as an Odin CSV electrode configuration file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>outfile</strong> (<em>str</em>) – Name of the output file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">str</span></code> if outfile is <code class="docutils literal"><span class="pre">None</span></code> else <code class="docutils literal"><span class="pre">None</span></code> and writes to <code class="docutils literal"><span class="pre">outfile</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For now, this only works if the configuration was generated from an
existing CSV file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="bptools.odin.config.SenseChannel">
<em class="property">class </em><code class="descclassname">bptools.odin.config.</code><code class="descname">SenseChannel</code><span class="sig-paren">(</span><em>name</em>, <em>contact</em>, <em>ref</em>, <em>description</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#SenseChannel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.SenseChannel" title="Permalink to this definition">¶</a></dt>
<dd><p>Data for a configured sense channel. This consists of two contacts: the
primary contact and the reference contact.</p>
</dd></dl>

<dl class="class">
<dt id="bptools.odin.config.StimChannel">
<em class="property">class </em><code class="descclassname">bptools.odin.config.</code><code class="descname">StimChannel</code><span class="sig-paren">(</span><em>name</em>, <em>anode</em>, <em>cathode</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#StimChannel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.StimChannel" title="Permalink to this definition">¶</a></dt>
<dd><p>Data for a configured stimulation channel.</p>
</dd></dl>

<dl class="function">
<dt id="bptools.odin.config.make_config_name">
<code class="descclassname">bptools.odin.config.</code><code class="descname">make_config_name</code><span class="sig-paren">(</span><em>subject</em>, <em>localization</em>, <em>montage</em>, <em>stim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#make_config_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.make_config_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the configuration filename using the standard naming convetion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>subject</strong> (<em>str</em>) – </li>
<li><strong>localization</strong> (<em>int</em>) – </li>
<li><strong>montage</strong> (<em>int</em>) – </li>
<li><strong>stim</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bptools.odin.config.make_odin_config">
<code class="descclassname">bptools.odin.config.</code><code class="descname">make_odin_config</code><span class="sig-paren">(</span><em>jacksheet_filename</em>, <em>config_name</em>, <em>default_surface_area</em>, <em>path=None</em>, <em>good_leads=None</em>, <em>scheme=’bipolar’</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/odin/config.html#make_odin_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.odin.config.make_odin_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an Odin ENS electrode configuration CSV file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>jacksheet_filename</strong> (<em>str</em>) – Input jacksheet filename.</li>
<li><strong>config_name</strong> (<em>str</em>) – Configuration file name.</li>
<li><strong>default_surface_area</strong> (<em>float</em>) – Default surface area for electrodes.</li>
<li><strong>path</strong> (<em>str</em>) – Directory to write file to. If None, return as a string.</li>
<li><strong>good_leads</strong> (<em>list</em><em> or </em><em>None</em>) – Jackbox numbers to use when configuring sense channels. This is usually
determined from the <code class="docutils literal"><span class="pre">good_leads.txt</span></code> file. When None, use all.</li>
<li><strong>scheme</strong> (<em>str</em>) – Referencing scheme to use (<code class="docutils literal"><span class="pre">bipolar</span></code> or <code class="docutils literal"><span class="pre">monopolar</span></code>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>In the future, jacksheets should optionally include extra annotations such
as type of electrode (depth, grid, strip) and surface areas.</p>
</dd></dl>

</div>
<div class="section" id="bipolar-transformation-utilities">
<h3>Bipolar transformation utilities<a class="headerlink" href="#bipolar-transformation-utilities" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="bptools.transform.SeriesTransformation">
<em class="property">class </em><code class="descclassname">bptools.transform.</code><code class="descname">SeriesTransformation</code><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="bptools.transform.SeriesTransformation.bipolar_2_monopolar_transformation">
<code class="descname">bipolar_2_monopolar_transformation</code><span class="sig-paren">(</span><em>ens_signal_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.bipolar_2_monopolar_transformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.bipolar_2_monopolar_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies bipolar to monopolar transformation to recover monopolar readings</p>
<p>Here is an example:
you get EEG signal - make sure that each row is a time series representing single channel recording
i.e. your eeg array (EEG_ARRAY) should look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">time</span><span class="o">----------------&gt;</span>
<span class="mi">0</span>  <span class="o">|</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span><span class="mi">56</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">78</span> <span class="mi">78</span>
<span class="mi">1</span>  <span class="o">|</span> <span class="mi">34</span> <span class="mi">45</span> <span class="mi">56</span> <span class="mi">67</span> <span class="mi">78</span> <span class="mi">23</span> <span class="mi">45</span> <span class="mi">56</span> <span class="mi">56</span>
<span class="mi">2</span>  <span class="o">|</span> <span class="mi">23</span> <span class="mi">45</span> <span class="mi">56</span> <span class="mi">23</span> <span class="mi">45</span> <span class="mi">667</span> <span class="mi">67</span> <span class="mi">34</span> <span class="mi">23</span>
<span class="o">...</span>
<span class="mi">100</span> <span class="o">|</span>
<span class="o">^</span>
<span class="o">|</span>
<span class="n">channels</span>
</pre></div>
</div>
<p>The transformation then is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">EEG_ARRAYTRANSFORMED</span> <span class="o">=</span> <span class="n">transformation_matrix</span> <span class="o">*</span> <span class="n">EEG_ARRAY</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ens_signal_array</strong> – 2D array (or nm.matrix) with the following dimensions (num_channels, sample_len)</td>
</tr>
</tbody>
</table>
<p>:return:numpy array shape=(num_channels, sample_len) of monopolar readings</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.transform.SeriesTransformation.bipolar_pairs_recarray">
<code class="descname">bipolar_pairs_recarray</code><a class="headerlink" href="#bptools.transform.SeriesTransformation.bipolar_pairs_recarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns montage recarray
:return: {ndarray} montage recarray with the following columns:
(contact_name, ch0_label, ch1_label, ch1_idx, ch1_idx)</p>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.bipolar_pairs_signal">
<code class="descname">bipolar_pairs_signal</code><span class="sig-paren">(</span><em>ens_signal_array</em>, <em>exclude_bipolar_pairs=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.bipolar_pairs_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.bipolar_pairs_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to reconstruct monopolar recordings from the ens_recordings and then use bipolar_pairs.json to
construct bipolar time series. If the bipolar-to-monopolar is impossible then we are
in the fully bipolar-sensing mode and then we simply return ens_signal_array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ens_signal_array</strong> – 2D array (or nm.matrix) with the following
dimensions (num_channels, sample_len)</li>
<li><strong>exclude_bipolar_pairs</strong> – {bool} specifies whether bipolar time
series should be based on full set of bipolar pairs (as speciofied
in the self. montage_data) or whether
we should exclude bipolar pairs (specified in
self.excluded_montage_data)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">{ndarray} bipolar time series</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.bipolar_possible">
<code class="descname">bipolar_possible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.bipolar_possible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.bipolar_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines whether SeriesTransformation can produce bipolar pairs time
series from  ens_time_series</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.configure_bipolar_2_monopolar_transformation">
<code class="descname">configure_bipolar_2_monopolar_transformation</code><span class="sig-paren">(</span><em>electrode_config_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.configure_bipolar_2_monopolar_transformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.configure_bipolar_2_monopolar_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>reads bipolar-to-monopolar transformation matrix from the disk. In the future we may
generate this matrix on the fly if the proposed referencing scheme works as desired</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>electrode_config_file</strong> – {str} path to electrode configuration file</li>
<li><strong>subject</strong> – {str} subject code (e.g. R1232N)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="bptools.transform.SeriesTransformation.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>electrode_config_file</em>, <em>montage_file=None</em>, <em>excluded_montage_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.create" title="Permalink to this definition">¶</a></dt>
<dd><p>reads electrode config .csv file and stores ElectrodeConfig instance as member variable
It also initializes transformation matrices (if possible) and configures bp_pairs-related variables
that will be used in the ens_data_array -&gt; monopolar or ens_data_array -&gt; bipolar</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>electrode_config_file</strong> – {str} path to electrode configuration file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.get_monopolar_to_bipolar_matrix">
<code class="descname">get_monopolar_to_bipolar_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.get_monopolar_to_bipolar_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.get_monopolar_to_bipolar_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs monopolar to bipolar transformation matrix
The algorithm is as follows:</p>
<ol class="arabic simple">
<li>We declare 256x256 zero matrix (because we can expect at most 256 sense channels in the ENS</li>
<li>We iterate over sense channels (sorted by jackbox number) and put 1 in the [jack_box_num, jack_box_num]
position and -1 in the [jack_box, ref_jack_box_num]</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>elec_conf</strong> – {instance of ElectrodeConfig}</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">{ndarray} monopolar to bipolar matrix as ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.monopolar_possible">
<code class="descname">monopolar_possible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.monopolar_possible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.monopolar_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines whether we can recover monopolar recordings or not
:return: {bool} “false” means that we can only get bipolar time series
“false” means we can recover bipolar recordings</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.transform.SeriesTransformation.monopolar_recarray">
<code class="descname">monopolar_recarray</code><a class="headerlink" href="#bptools.transform.SeriesTransformation.monopolar_recarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns contacts recarray (as declared int he electrode configuration)
:return: {ndarray} contacts recarray witht eh following columns
(jack_box_num,contact_name, description)</p>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.monopolar_signal">
<code class="descname">monopolar_signal</code><span class="sig-paren">(</span><em>ens_signal_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.monopolar_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.monopolar_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses bipolar_2_monopolar_transformation to extract monopolar_recordings if monopolar recordings are possible
Otherwise raises exception</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ens_signal_array</strong> – 2D array (or nm.matrix) with the following dimensions (num_sense_channels, sample_len)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">monopolar signal numpy array shape=(num_monopolar_channels, sample_len)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.monopolar_trans_matrix_via_inverse">
<code class="descname">monopolar_trans_matrix_via_inverse</code><span class="sig-paren">(</span><em>elec_conf=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.monopolar_trans_matrix_via_inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.monopolar_trans_matrix_via_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that computes transformation matrix that takes mixed mode (a.k. Medtronic bipolar) recording and
transforms it into monopolar recordings.
IMPORTANT: the algoritm implemented in this function works only for the mixed-mode referencing scheme
proposed by Medtronic - i.e. banks of 16 electrodes where one electrode is connected to C/R  and
other electrode in the bank reference it</p>
<p>Here is what we are doing:
Example</p>
<p>E1 - connected to CR
E2, E2 ,E3 are referenced to E1</p>
<p>and in the experiment we measure E1, E2E1, E3E1, E4E1</p>
<p>For this we get the following system of eqns:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="n">E1</span>
<span class="n">E2</span> <span class="o">-</span> <span class="n">E1</span> <span class="o">=</span> <span class="n">E2E1</span>
<span class="n">E3</span> <span class="o">-</span> <span class="n">E1</span> <span class="o">=</span> <span class="n">E3E1</span>
<span class="n">E4</span> <span class="o">-</span> <span class="n">E1</span> <span class="o">=</span> <span class="n">E4E1</span>
</pre></div>
</div>
<p>or in matrix form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="o">|</span>  <span class="o">|</span><span class="n">E1</span><span class="o">|</span>   <span class="o">|</span> <span class="n">E1</span>   <span class="o">|</span>
<span class="o">|</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="o">|</span>  <span class="o">|</span><span class="n">E2</span><span class="o">|</span>   <span class="o">|</span> <span class="n">E2E1</span> <span class="o">|</span>
<span class="o">|</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span> <span class="o">|*</span> <span class="o">|</span><span class="n">E3</span><span class="o">|</span> <span class="o">=</span> <span class="o">|</span> <span class="n">E3E1</span> <span class="o">|</span>
<span class="o">|</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span> <span class="o">|</span>  <span class="o">|</span><span class="n">E4</span><span class="o">|</span>   <span class="o">|</span> <span class="n">E3E1</span> <span class="o">|</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">*</span><span class="n">E_monopolar</span> <span class="o">=</span> <span class="n">E_bipolar</span>
</pre></div>
</div>
<p>Therefore to find monopolar recordings ew invert matrix A</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">{numpy matrix} transformation matrix - mixed-mode -&gt; monopolar. This is the inverse of A</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="bptools.transform.SeriesTransformation.net_bipolar_pairs_recarray">
<code class="descname">net_bipolar_pairs_recarray</code><a class="headerlink" href="#bptools.transform.SeriesTransformation.net_bipolar_pairs_recarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns montage recarray but does not include excluded pairs
:return: {ndarray} montage recarray with the following columns:
(contact_name, ch0_label, ch1_label, ch1_idx, ch1_idx)</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.transform.SeriesTransformation.net_num_bp">
<code class="descname">net_num_bp</code><a class="headerlink" href="#bptools.transform.SeriesTransformation.net_num_bp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns number of bipolar pairs in the net montage data. Typically used in classifier computations
Note this is not necessarily the number of total sensing bipolar pairs, because some of the bps
could have been excluded in the net_montage_data
:return: {int} number of bps</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.transform.SeriesTransformation.num_all_bp">
<code class="descname">num_all_bp</code><a class="headerlink" href="#bptools.transform.SeriesTransformation.num_all_bp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of ALL bipolar_pairs (if montage is provided or if full bp config is inplace)
:return: {int}</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.transform.SeriesTransformation.num_sense_channels">
<code class="descname">num_sense_channels</code><a class="headerlink" href="#bptools.transform.SeriesTransformation.num_sense_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of sense channels as stored int he elec_conf
:return: {int}</p>
</dd></dl>

<dl class="attribute">
<dt id="bptools.transform.SeriesTransformation.sense_channel_recarray">
<code class="descname">sense_channel_recarray</code><a class="headerlink" href="#bptools.transform.SeriesTransformation.sense_channel_recarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns contacts recarray (as declared int he electrode configuration)
:return: {ndarray} contacts recarray witht eh following columns
(jack_box_num,contact_name, description)</p>
</dd></dl>

<dl class="method">
<dt id="bptools.transform.SeriesTransformation.transform_signal">
<code class="descname">transform_signal</code><span class="sig-paren">(</span><em>ens_signal_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bptools/transform.html#SeriesTransformation.transform_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bptools.transform.SeriesTransformation.transform_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies bipolar-to-monopolar transformation to recover monopolar readings (if possible)</p>
<p>Here is an example:
you get EEG signal - make sure that each row is a time series representing single channel recording
i.e. your eeg array (EEG_ARRAY) should look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">time</span><span class="o">----------------&gt;</span>
<span class="mi">0</span>  <span class="o">|</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span><span class="mi">56</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">78</span> <span class="mi">78</span>
<span class="mi">1</span>  <span class="o">|</span> <span class="mi">34</span> <span class="mi">45</span> <span class="mi">56</span> <span class="mi">67</span> <span class="mi">78</span> <span class="mi">23</span> <span class="mi">45</span> <span class="mi">56</span> <span class="mi">56</span>
<span class="mi">2</span>  <span class="o">|</span> <span class="mi">23</span> <span class="mi">45</span> <span class="mi">56</span> <span class="mi">23</span> <span class="mi">45</span> <span class="mi">667</span> <span class="mi">67</span> <span class="mi">34</span> <span class="mi">23</span>
<span class="o">...</span>
<span class="mi">100</span> <span class="o">|</span>
<span class="o">^</span>
<span class="o">|</span>
<span class="n">channels</span>
</pre></div>
</div>
<p>The transformation then is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">EEG_ARRAYTRANSFORMED</span> <span class="o">=</span> <span class="n">transformation_matrix</span> <span class="o">*</span> <span class="n">EEG_ARRAY</span>
</pre></div>
</div>
<p>If such transformation is not possible it means we are in the fully bipolar mode and then we return signal_array
because there is not transformation to be made</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ens_signal_array</strong> – 2D array (or nm.matrix) with the following dimensions (num_channels, sample_len)</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>:return:numpy array shape=(num_channels, sample_len) of monopolar readings</dt>
<dd>or signal_array if bipolar_2_monopolar transformation is impossible</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">bptools</a><ul>
<li><a class="reference internal" href="#electrode-config-generation">Electrode config generation</a><ul>
<li><a class="reference internal" href="#known-issues">Known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-reference">API reference</a><ul>
<li><a class="reference internal" href="#module-bptools.jacksheet">Jacksheet utilities</a></li>
<li><a class="reference internal" href="#module-bptools.pairs">Pair creation tools</a></li>
<li><a class="reference internal" href="#module-bptools.odin.config">Odin ENS configuration</a></li>
<li><a class="reference internal" href="#bipolar-transformation-utilities">Bipolar transformation utilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">bptools 1.1.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Penn Computational Memory Lab.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.2.
    </div>
  </body>
</html>